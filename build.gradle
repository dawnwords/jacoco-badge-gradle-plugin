/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/5.3.1/userguide/java_library_plugin.html
 */

plugins {
    id 'java'
    id 'java-gradle-plugin'
    id 'maven'
    id 'jacoco'
    id 'maven-publish'
    id "com.gradle.plugin-publish" version "0.13.0"
    id 'com.github.kt3k.coveralls' version '2.8.2'
}

group = 'com.github.dawnwords'
version = '0.2.3'

repositories {
    jcenter()
}

dependencies {
    compile gradleApi()
    compile 'commons-io:commons-io:2.6'

    // Use TestNG framework, also requires calling test.useTestNG() below
    testImplementation 'org.testng:testng:6.14.3'
    testCompile 'org.mockito:mockito-core:2.28.2'
}

test {
    // Use TestNG for unit tests
    useTestNG()
}

gradlePlugin {
    plugins {
        greetingsPlugin {
            id = 'com.github.dawnwords.jacoco.badge'
            implementationClass = 'com.github.dawnwords.jacoco.badge.JacocoBadgePlugin'
        }
    }
}

pluginBundle {
    description = 'Jacoco Badge Generator'
    tags = ['coverage', 'badge']

    website = 'https://github.com/dawnwords/jacoco-badge-gradle-plugin'
    vcsUrl = 'https://github.com/dawnwords/jacoco-badge-gradle-plugin'

    plugins {
        greetingsPlugin {
            displayName = 'Jacoco Badge Generator'
        }
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
    }
}

jacocoTestCoverageVerification {
    violationRules {
        rule {
            limit {
                minimum = 0.9
            }
        }
    }
}

check.finalizedBy(jacocoTestCoverageVerification)

coveralls {
    jacocoReportPath 'build/reports/jacoco/test/jacocoTestReport.xml'
}
